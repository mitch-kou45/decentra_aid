{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.encodeTuple = encodeTuple;\nexports.decodeTuple = decodeTuple;\n/*\nThis file is part of web3.js.\n\nweb3.js is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nweb3.js is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License\nalong with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\nconst web3_errors_1 = require(\"web3-errors\");\nconst web3_utils_1 = require(\"web3-utils\");\n// eslint-disable-next-line import/no-cycle\nconst index_js_1 = require(\"./index.js\");\nconst utils_js_1 = require(\"./utils.js\");\nconst utils_js_2 = require(\"../utils.js\");\nconst number_js_1 = require(\"./number.js\");\nfunction encodeTuple(param, input) {\n  var _a, _b, _c;\n  let dynamic = false;\n  if (!Array.isArray(input) && typeof input !== 'object') {\n    throw new web3_errors_1.AbiError('param must be either Array or Object', {\n      param,\n      input\n    });\n  }\n  const narrowedInput = input;\n  const encoded = [];\n  for (let i = 0; i < ((_b = (_a = param.components) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0); i += 1) {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const paramComponent = param.components[i];\n    let result;\n    if (Array.isArray(narrowedInput)) {\n      if (i >= narrowedInput.length) {\n        throw new web3_errors_1.AbiError('input param length missmatch', {\n          param,\n          input\n        });\n      }\n      result = (0, index_js_1.encodeParamFromAbiParameter)(paramComponent, narrowedInput[i]);\n    } else {\n      const paramInput = narrowedInput[(_c = paramComponent.name) !== null && _c !== void 0 ? _c : ''];\n      // eslint-disable-next-line no-null/no-null\n      if (paramInput === undefined || paramInput === null) {\n        throw new web3_errors_1.AbiError('missing input defined in abi', {\n          param,\n          input,\n          paramName: paramComponent.name\n        });\n      }\n      result = (0, index_js_1.encodeParamFromAbiParameter)(paramComponent, paramInput);\n    }\n    if (result.dynamic) {\n      dynamic = true;\n    }\n    encoded.push(result);\n  }\n  if (dynamic) {\n    return {\n      dynamic: true,\n      encoded: (0, utils_js_1.encodeDynamicParams)(encoded)\n    };\n  }\n  return {\n    dynamic: false,\n    encoded: (0, web3_utils_1.uint8ArrayConcat)(...encoded.map(e => e.encoded))\n  };\n}\nfunction decodeTuple(param, bytes) {\n  const result = {\n    __length__: 0\n  };\n  // tracks how much static params consumed bytes\n  let consumed = 0;\n  if (!param.components) {\n    return {\n      result,\n      encoded: bytes,\n      consumed\n    };\n  }\n  // track how much dynamic params consumed bytes\n  let dynamicConsumed = 0;\n  for (const [index, childParam] of param.components.entries()) {\n    let decodedResult;\n    if ((0, utils_js_2.isDynamic)(childParam)) {\n      // if dynamic, we will have offset encoded\n      const offsetResult = (0, number_js_1.decodeNumber)({\n        type: 'uint32',\n        name: ''\n      }, bytes.subarray(consumed));\n      // offset counts from start of original byte sequence\n      decodedResult = (0, index_js_1.decodeParamFromAbiParameter)(childParam, bytes.subarray(Number(offsetResult.result)));\n      consumed += offsetResult.consumed;\n      dynamicConsumed += decodedResult.consumed;\n    } else {\n      // static param, just decode\n      decodedResult = (0, index_js_1.decodeParamFromAbiParameter)(childParam, bytes.subarray(consumed));\n      consumed += decodedResult.consumed;\n    }\n    result.__length__ += 1;\n    result[index] = decodedResult.result;\n    if (childParam.name && childParam.name !== '') {\n      result[childParam.name] = decodedResult.result;\n    }\n  }\n  return {\n    encoded: bytes.subarray(consumed + dynamicConsumed),\n    result,\n    consumed: consumed + dynamicConsumed\n  };\n}","map":{"version":3,"names":["exports","encodeTuple","decodeTuple","web3_errors_1","require","web3_utils_1","index_js_1","utils_js_1","utils_js_2","number_js_1","param","input","dynamic","Array","isArray","AbiError","narrowedInput","encoded","i","_b","_a","components","length","paramComponent","result","encodeParamFromAbiParameter","paramInput","_c","name","undefined","paramName","push","encodeDynamicParams","uint8ArrayConcat","map","e","bytes","__length__","consumed","dynamicConsumed","index","childParam","entries","decodedResult","isDynamic","offsetResult","decodeNumber","type","subarray","decodeParamFromAbiParameter","Number"],"sources":["/home/nathan/node_modules/web3-eth-abi/src/coders/base/tuple.ts"],"sourcesContent":["/*\nThis file is part of web3.js.\n\nweb3.js is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nweb3.js is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License\nalong with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { AbiError } from 'web3-errors';\nimport { AbiParameter } from 'web3-types';\nimport { uint8ArrayConcat } from 'web3-utils';\nimport { DecoderResult, EncoderResult } from '../types.js';\n// eslint-disable-next-line import/no-cycle\nimport { decodeParamFromAbiParameter, encodeParamFromAbiParameter } from './index.js';\nimport { encodeDynamicParams } from './utils.js';\nimport { isDynamic } from '../utils.js';\nimport { decodeNumber } from './number.js';\n\nexport function encodeTuple(param: AbiParameter, input: unknown): EncoderResult {\n\tlet dynamic = false;\n\tif (!Array.isArray(input) && typeof input !== 'object') {\n\t\tthrow new AbiError('param must be either Array or Object', {\n\t\t\tparam,\n\t\t\tinput,\n\t\t});\n\t}\n\tconst narrowedInput = input as Array<unknown> | Record<string, unknown>;\n\tconst encoded: Array<EncoderResult> = [];\n\tfor (let i = 0; i < (param.components?.length ?? 0); i += 1) {\n\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\tconst paramComponent = param.components![i];\n\t\tlet result: EncoderResult;\n\t\tif (Array.isArray(narrowedInput)) {\n\t\t\tif (i >= narrowedInput.length) {\n\t\t\t\tthrow new AbiError('input param length missmatch', {\n\t\t\t\t\tparam,\n\t\t\t\t\tinput,\n\t\t\t\t});\n\t\t\t}\n\t\t\tresult = encodeParamFromAbiParameter(paramComponent, narrowedInput[i]);\n\t\t} else {\n\t\t\tconst paramInput = narrowedInput[paramComponent.name ?? ''];\n\t\t\t// eslint-disable-next-line no-null/no-null\n\t\t\tif (paramInput === undefined || paramInput === null) {\n\t\t\t\tthrow new AbiError('missing input defined in abi', {\n\t\t\t\t\tparam,\n\t\t\t\t\tinput,\n\t\t\t\t\tparamName: paramComponent.name,\n\t\t\t\t});\n\t\t\t}\n\t\t\tresult = encodeParamFromAbiParameter(paramComponent, paramInput);\n\t\t}\n\t\tif (result.dynamic) {\n\t\t\tdynamic = true;\n\t\t}\n\t\tencoded.push(result);\n\t}\n\n\tif (dynamic) {\n\t\treturn {\n\t\t\tdynamic: true,\n\t\t\tencoded: encodeDynamicParams(encoded),\n\t\t};\n\t}\n\treturn {\n\t\tdynamic: false,\n\t\tencoded: uint8ArrayConcat(...encoded.map(e => e.encoded)),\n\t};\n}\n\nexport function decodeTuple(\n\tparam: AbiParameter,\n\tbytes: Uint8Array,\n): DecoderResult<{ [key: string]: unknown; __length__: number }> {\n\tconst result: { [key: string]: unknown; __length__: number } = {\n\t\t__length__: 0,\n\t};\n\n\t// tracks how much static params consumed bytes\n\tlet consumed = 0;\n\n\tif (!param.components) {\n\t\treturn {\n\t\t\tresult,\n\t\t\tencoded: bytes,\n\t\t\tconsumed,\n\t\t};\n\t}\n\t// track how much dynamic params consumed bytes\n\tlet dynamicConsumed = 0;\n\tfor (const [index, childParam] of param.components.entries()) {\n\t\tlet decodedResult: DecoderResult;\n\t\tif (isDynamic(childParam)) {\n\t\t\t// if dynamic, we will have offset encoded\n\t\t\tconst offsetResult = decodeNumber(\n\t\t\t\t{ type: 'uint32', name: '' },\n\t\t\t\tbytes.subarray(consumed),\n\t\t\t);\n\t\t\t// offset counts from start of original byte sequence\n\t\t\tdecodedResult = decodeParamFromAbiParameter(\n\t\t\t\tchildParam,\n\t\t\t\tbytes.subarray(Number(offsetResult.result)),\n\t\t\t);\n\t\t\tconsumed += offsetResult.consumed;\n\t\t\tdynamicConsumed += decodedResult.consumed;\n\t\t} else {\n\t\t\t// static param, just decode\n\t\t\tdecodedResult = decodeParamFromAbiParameter(childParam, bytes.subarray(consumed));\n\t\t\tconsumed += decodedResult.consumed;\n\t\t}\n\t\tresult.__length__ += 1;\n\t\tresult[index] = decodedResult.result;\n\t\tif (childParam.name && childParam.name !== '') {\n\t\t\tresult[childParam.name] = decodedResult.result;\n\t\t}\n\t}\n\treturn {\n\t\tencoded: bytes.subarray(consumed + dynamicConsumed),\n\t\tresult,\n\t\tconsumed: consumed + dynamicConsumed,\n\t};\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}