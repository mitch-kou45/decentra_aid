{"ast":null,"code":"\"use strict\";\n\n/*\nThis file is part of web3.js.\n\nweb3.js is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nweb3.js is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License\nalong with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Web3ExternalProvider = void 0;\nconst web3_providers_http_1 = __importDefault(require(\"web3-providers-http\"));\nconst web3_providers_ws_1 = __importDefault(require(\"web3-providers-ws\"));\nconst web3_utils_1 = require(\"web3-utils\");\nconst types_js_1 = require(\"./types.js\");\nconst errors_js_1 = require(\"./errors.js\");\n/*\nThis class can be used to create new providers only when there is custom logic required in each Request method like\nchecking specific HTTP status codes and performing any action, throwing new error types or setting additional HTTP headers in requests, or even modifying requests.\n\nAnother simpler approach can be a function simply returning URL strings instead of using the following class in case if\nno additional logic implementation is required in the provider.\n*/\nclass Web3ExternalProvider extends web3_utils_1.Eip1193Provider {\n  constructor(network, transport, token, host, providerConfigOptions) {\n    super();\n    if (providerConfigOptions !== undefined && transport === types_js_1.Transport.HTTPS && !('providerOptions' in providerConfigOptions)) {\n      throw new errors_js_1.ProviderConfigOptionsError('HTTP Provider');\n    } else if (providerConfigOptions !== undefined && transport === types_js_1.Transport.WebSocket && !('socketOptions' in providerConfigOptions || 'reconnectOptions' in providerConfigOptions)) {\n      throw new errors_js_1.ProviderConfigOptionsError('Websocket Provider');\n    }\n    this.transport = transport;\n    if (transport === types_js_1.Transport.HTTPS) {\n      this.provider = new web3_providers_http_1.default(this.getRPCURL(network, transport, token, host), providerConfigOptions);\n    } else if (transport === types_js_1.Transport.WebSocket) {\n      this.provider = new web3_providers_ws_1.default(this.getRPCURL(network, transport, token, host), providerConfigOptions === null || providerConfigOptions === void 0 ? void 0 : providerConfigOptions.socketOptions, providerConfigOptions === null || providerConfigOptions === void 0 ? void 0 : providerConfigOptions.reconnectOptions);\n    }\n  }\n  request(payload, requestOptions) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (this.transport === types_js_1.Transport.HTTPS) {\n        return yield this.provider.request(payload, requestOptions);\n      }\n      return this.provider.request(payload);\n    });\n  }\n  getStatus() {\n    return this.provider.getStatus();\n  }\n  supportsSubscriptions() {\n    return this.provider.supportsSubscriptions();\n  }\n  once(_type, _listener) {\n    var _a;\n    if ((_a = this.provider) === null || _a === void 0 ? void 0 : _a.once) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      this.provider.once(_type, _listener);\n    }\n  }\n  removeAllListeners(_type) {\n    var _a;\n    if ((_a = this.provider) === null || _a === void 0 ? void 0 : _a.removeAllListeners) this.provider.removeAllListeners(_type);\n  }\n  connect() {\n    var _a;\n    if ((_a = this.provider) === null || _a === void 0 ? void 0 : _a.connect) this.provider.connect();\n  }\n  disconnect(_code, _data) {\n    var _a;\n    if ((_a = this.provider) === null || _a === void 0 ? void 0 : _a.disconnect) this.provider.disconnect(_code, _data);\n  }\n  reset() {\n    var _a;\n    if ((_a = this.provider) === null || _a === void 0 ? void 0 : _a.reset) this.provider.reset();\n  }\n  on(_type, _listener) {\n    if (this.provider)\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      this.provider.on(_type, _listener);\n  }\n  removeListener(_type, _listener) {\n    if (this.provider) this.provider.removeListener(_type, _listener);\n  }\n}\nexports.Web3ExternalProvider = Web3ExternalProvider;","map":{"version":3,"names":["web3_providers_http_1","__importDefault","require","web3_providers_ws_1","web3_utils_1","types_js_1","errors_js_1","Web3ExternalProvider","Eip1193Provider","constructor","network","transport","token","host","providerConfigOptions","undefined","Transport","HTTPS","ProviderConfigOptionsError","WebSocket","provider","default","getRPCURL","socketOptions","reconnectOptions","request","payload","requestOptions","getStatus","supportsSubscriptions","once","_type","_listener","_a","removeAllListeners","connect","disconnect","_code","_data","reset","on","removeListener","exports"],"sources":["/home/osboxes/node_modules/web3-rpc-providers/src/web3_provider.ts"],"sourcesContent":["/*\nThis file is part of web3.js.\n\nweb3.js is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nweb3.js is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License\nalong with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nimport HttpProvider, { HttpProviderOptions } from 'web3-providers-http';\nimport WebSocketProvider from 'web3-providers-ws';\nimport {\n\tEthExecutionAPI,\n\tJsonRpcResult,\n\tProviderConnectInfo,\n\tProviderMessage,\n\tProviderRpcError,\n\tWeb3APIMethod,\n\tWeb3APIPayload,\n\tWeb3APIReturnType,\n\tWeb3APISpec,\n\tWeb3BaseProvider,\n\tWeb3Eip1193ProviderEventCallback,\n\tWeb3ProviderEventCallback,\n\tWeb3ProviderMessageEventCallback,\n\tWeb3ProviderStatus,\n\tJsonRpcResponseWithResult,\n} from 'web3-types';\nimport { Eip1193Provider } from 'web3-utils';\nimport { Transport, Network, SocketOptions } from './types.js';\nimport { ProviderConfigOptionsError } from './errors.js';\n\n/* \nThis class can be used to create new providers only when there is custom logic required in each Request method like\nchecking specific HTTP status codes and performing any action, throwing new error types or setting additional HTTP headers in requests, or even modifying requests.\n\nAnother simpler approach can be a function simply returning URL strings instead of using the following class in case if\nno additional logic implementation is required in the provider.\n*/\n\nexport abstract class Web3ExternalProvider<\n\tAPI extends Web3APISpec = EthExecutionAPI,\n> extends Eip1193Provider {\n\tpublic provider!: Web3BaseProvider;\n\tpublic readonly transport: Transport;\n\n\tpublic abstract getRPCURL(\n\t\tnetwork: Network,\n\t\ttransport: Transport,\n\t\ttoken: string,\n\t\thost: string,\n\t): string;\n\n\tpublic constructor(\n\t\tnetwork: Network,\n\t\ttransport: Transport,\n\t\ttoken: string,\n\t\thost: string,\n\t\tproviderConfigOptions?: HttpProviderOptions | SocketOptions,\n\t) {\n\t\tsuper();\n\n\t\tif (\n\t\t\tproviderConfigOptions !== undefined &&\n\t\t\ttransport === Transport.HTTPS &&\n\t\t\t!('providerOptions' in providerConfigOptions)\n\t\t) {\n\t\t\tthrow new ProviderConfigOptionsError('HTTP Provider');\n\t\t} else if (\n\t\t\tproviderConfigOptions !== undefined &&\n\t\t\ttransport === Transport.WebSocket &&\n\t\t\t!(\n\t\t\t\t'socketOptions' in providerConfigOptions ||\n\t\t\t\t'reconnectOptions' in providerConfigOptions\n\t\t\t)\n\t\t) {\n\t\t\tthrow new ProviderConfigOptionsError('Websocket Provider');\n\t\t}\n\n\t\tthis.transport = transport;\n\t\tif (transport === Transport.HTTPS) {\n\t\t\tthis.provider = new HttpProvider(\n\t\t\t\tthis.getRPCURL(network, transport, token, host),\n\t\t\t\tproviderConfigOptions as HttpProviderOptions,\n\t\t\t);\n\t\t} else if (transport === Transport.WebSocket) {\n\t\t\tthis.provider = new WebSocketProvider(\n\t\t\t\tthis.getRPCURL(network, transport, token, host),\n\t\t\t\t(providerConfigOptions as SocketOptions)?.socketOptions,\n\t\t\t\t(providerConfigOptions as SocketOptions)?.reconnectOptions,\n\t\t\t);\n\t\t}\n\t}\n\n\tpublic async request<\n\t\tMethod extends Web3APIMethod<API>,\n\t\tResultType = Web3APIReturnType<API, Method>,\n\t>(\n\t\tpayload: Web3APIPayload<EthExecutionAPI, Method>,\n\t\trequestOptions?: RequestInit,\n\t): Promise<JsonRpcResponseWithResult<ResultType>> {\n\t\tif (this.transport === Transport.HTTPS) {\n\t\t\treturn (await (this.provider as HttpProvider).request(\n\t\t\t\tpayload,\n\t\t\t\trequestOptions,\n\t\t\t)) as unknown as JsonRpcResponseWithResult<ResultType>;\n\t\t}\n\n\t\treturn (this.provider as WebSocketProvider).request(payload);\n\t}\n\n\tpublic getStatus(): Web3ProviderStatus {\n\t\treturn this.provider.getStatus();\n\t}\n\tpublic supportsSubscriptions(): boolean {\n\t\treturn this.provider.supportsSubscriptions();\n\t}\n\tpublic once(\n\t\ttype: 'disconnect',\n\t\tlistener: Web3Eip1193ProviderEventCallback<ProviderRpcError>,\n\t): void;\n\tpublic once<T = JsonRpcResult>(\n\t\ttype: string,\n\t\tlistener: Web3Eip1193ProviderEventCallback<ProviderMessage> | Web3ProviderEventCallback<T>,\n\t): void;\n\tpublic once(\n\t\ttype: 'connect',\n\t\tlistener: Web3Eip1193ProviderEventCallback<ProviderConnectInfo>,\n\t): void;\n\tpublic once(type: 'chainChanged', listener: Web3Eip1193ProviderEventCallback<string>): void;\n\tpublic once(\n\t\ttype: 'accountsChanged',\n\t\tlistener: Web3Eip1193ProviderEventCallback<string[]>,\n\t): void;\n\tpublic once(_type: string, _listener: unknown): void {\n\t\tif (this.provider?.once) {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n\t\t\tthis.provider.once(\n\t\t\t\t_type,\n\t\t\t\t_listener as\n\t\t\t\t\t| Web3Eip1193ProviderEventCallback<ProviderMessage>\n\t\t\t\t\t| Web3ProviderEventCallback,\n\t\t\t);\n\t\t}\n\t}\n\tpublic removeAllListeners?(_type: string): void {\n\t\tif (this.provider?.removeAllListeners) this.provider.removeAllListeners(_type);\n\t}\n\tpublic connect(): void {\n\t\tif (this.provider?.connect) this.provider.connect();\n\t}\n\tpublic disconnect(_code?: number | undefined, _data?: string | undefined): void {\n\t\tif (this.provider?.disconnect) this.provider.disconnect(_code, _data);\n\t}\n\tpublic reset(): void {\n\t\tif (this.provider?.reset) this.provider.reset();\n\t}\n\n\tpublic on(\n\t\ttype: 'disconnect',\n\t\tlistener: Web3Eip1193ProviderEventCallback<ProviderRpcError>,\n\t): void;\n\tpublic on<T = JsonRpcResult>(\n\t\ttype: string,\n\t\tlistener:\n\t\t\t| Web3Eip1193ProviderEventCallback<ProviderMessage>\n\t\t\t| Web3ProviderMessageEventCallback<T>,\n\t): void;\n\tpublic on<T = JsonRpcResult>(\n\t\ttype: string,\n\t\tlistener:\n\t\t\t| Web3Eip1193ProviderEventCallback<ProviderMessage>\n\t\t\t| Web3ProviderMessageEventCallback<T>,\n\t): void;\n\tpublic on(\n\t\ttype: 'connect',\n\t\tlistener: Web3Eip1193ProviderEventCallback<ProviderConnectInfo>,\n\t): void;\n\tpublic on(type: 'chainChanged', listener: Web3Eip1193ProviderEventCallback<string>): void;\n\tpublic on(type: 'accountsChanged', listener: Web3Eip1193ProviderEventCallback<string[]>): void;\n\tpublic on(_type: unknown, _listener: unknown): void {\n\t\tif (this.provider)\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n\t\t\tthis.provider.on(\n\t\t\t\t_type as string,\n\t\t\t\t_listener as\n\t\t\t\t\t| Web3Eip1193ProviderEventCallback<ProviderMessage>\n\t\t\t\t\t| Web3ProviderMessageEventCallback,\n\t\t\t);\n\t}\n\tpublic removeListener(\n\t\ttype: 'disconnect',\n\t\tlistener: Web3Eip1193ProviderEventCallback<ProviderRpcError>,\n\t): void;\n\tpublic removeListener<T = JsonRpcResult>(\n\t\ttype: string,\n\t\tlistener: Web3Eip1193ProviderEventCallback<ProviderMessage> | Web3ProviderEventCallback<T>,\n\t): void;\n\tpublic removeListener(\n\t\ttype: 'connect',\n\t\tlistener: Web3Eip1193ProviderEventCallback<ProviderConnectInfo>,\n\t): void;\n\tpublic removeListener(\n\t\ttype: 'chainChanged',\n\t\tlistener: Web3Eip1193ProviderEventCallback<string>,\n\t): void;\n\tpublic removeListener(\n\t\ttype: 'accountsChanged',\n\t\tlistener: Web3Eip1193ProviderEventCallback<string[]>,\n\t): void;\n\tpublic removeListener(_type: unknown, _listener: unknown): void {\n\t\tif (this.provider)\n\t\t\tthis.provider.removeListener(\n\t\t\t\t_type as string,\n\t\t\t\t_listener as\n\t\t\t\t\t| Web3Eip1193ProviderEventCallback<ProviderMessage>\n\t\t\t\t\t| Web3ProviderEventCallback,\n\t\t\t);\n\t}\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}